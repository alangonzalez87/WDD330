import{g as n,l}from"./utils-tUWCcRRk.js";import{E as u}from"./ProductData-DtkXwhN3.js";const h=new u;function m(s){const e=new FormData(s),t={};return e.forEach(function(o,i){t[i]=o}),t}function d(s){return s.map(t=>(console.log(t),{id:t.Id,price:t.FinalPrice,name:t.Name,quantity:1}))}class c{constructor(e,t){this.key=e,this.outputSelector=t,this.list=[],this.itemTotal=0,this.shipping=0,this.tax=0,this.orderTotal=0}init(){this.list=n(this.key),this.calculateItemSummary()}calculateItemSummary(){const e=document.querySelector(this.outputSelector+" #cartTotal"),t=document.querySelector(this.outputSelector+" #num-items");t.innerText=this.list.length;const o=this.list.map(i=>i.FinalPrice);this.itemTotal=o.reduce((i,a)=>i+a),e.innerText="$"+this.itemTotal}calculateOrdertotal(){this.shipping=10+(this.list.length-1)*2,this.tax=(this.itemTotal*.06).toFixed(2),this.orderTotal=(parseFloat(this.itemTotal)+parseFloat(this.shipping)+parseFloat(this.tax)).toFixed(2),this.displayOrderTotals()}displayOrderTotals(){const e=document.querySelector(this.outputSelector+" #shipping"),t=document.querySelector(this.outputSelector+" #tax"),o=document.querySelector(this.outputSelector+" #orderTotal");e.innerText="$"+this.shipping,t.innerText="$"+this.tax,o.innerText="$"+this.orderTotal}async checkout(){const e=document.forms.checkout,t=m(e);t.orderDate=new Date,t.orderTotal=this.orderTotal,t.tax=this.tax,t.shipping=this.shipping,t.items=d(this.list),console.log(t);try{const o=await h.checkout(t);console.log(o)}catch(o){console.log(o)}}}console.log(c);l();const r=new c("so-cart",".checkout-summary");console.log(c);r.init();document.querySelector("#zip").addEventListener("blur",r.calculateOrdertotal.bind(r));document.querySelector("#checkoutSubmit").addEventListener("click",s=>{s.preventDefault(),r.checkout()});
